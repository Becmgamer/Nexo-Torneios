<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NEXO Studios - Torneios</title>

<style>
body{
background:#0f0f0f;
color:white;
font-family:Arial;
margin:0;
padding:0;
}

header{
background:#00ffcc;
color:black;
padding:15px;
text-align:center;
font-size:22px;
font-weight:bold;
}

.container{
padding:20px;
}

.card{
background:#1a1a1a;
border:2px solid #00ffcc;
border-radius:15px;
padding:15px;
margin-bottom:20px;
box-shadow:0 0 15px #00ffcc;
}

button{
background:#00ffcc;
border:none;
padding:10px 15px;
border-radius:10px;
cursor:pointer;
font-weight:bold;
margin-top:10px;
}

button:hover{
background:#00ffaa;
}

input{
width:100%;
padding:10px;
margin-top:10px;
border-radius:8px;
border:none;
}

.pix-box{
display:none;
margin-top:15px;
background:#111;
padding:10px;
border-radius:10px;
border:1px solid #00ffcc;
}
footer{
margin-top:40px;
text-align:center;
font-size:12px;
color:gray;
padding:20px;
border-top:1px solid #333;
}
</style>
</head>
<body>

<header>NEXO Studios - Torneios</header>

<div class="container">

<div id="loginBox">
<h2>Login</h2>
<input type="email" id="email" placeholder="Digite seu email">
<input type="password" id="senha" placeholder="Digite sua senha">
<button onclick="login()">Entrar</button>
</div>

<div id="torneiosArea" style="display:none;"></div>

</div>

<footer>
PolÃ­tica de Privacidade | Regras do Torneio<br>
O telefone Ã© coletado apenas para contato sobre o torneio.
</footer>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, getDocs, addDoc, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
apiKey: "SUA_API_KEY",
authDomain: "SEU_AUTH_DOMAIN",
projectId: "SEU_PROJECT_ID",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = async function(){
const email = document.getElementById("email").value;
const senha = document.getElementById("senha").value;
await signInWithEmailAndPassword(auth,email,senha);
}

onAuthStateChanged(auth,(user)=>{
if(user){
document.getElementById("loginBox").style.display="none";
carregarTorneios();
}
});

async function carregarTorneios(){
const area = document.getElementById("torneiosArea");
area.style.display="block";
area.innerHTML="";

const querySnapshot = await getDocs(collection(db,"torneios"));

querySnapshot.forEach(async(docSnap)=>{
const data = docSnap.data();

const inscritosRef = collection(db,"torneios",docSnap.id,"inscritos");
const inscritosSnap = await getDocs(inscritosRef);

const vagas = inscritosSnap.size;

area.innerHTML += `
<div class="card">
<h2>${data.nome}</h2>
<p>ğŸ“… InscriÃ§Ãµes atÃ©: ${data.dataInscricao}</p>
<p>ğŸ® Torneio: ${data.dataTorneio}</p>
<p>ğŸ’° Taxa: R$ ${data.taxa}</p>
<p>ğŸ† 1Âº: R$ ${data.primeiro}</p>
<p>ğŸ¥ˆ 2Âº: R$ ${data.segundo}</p>
<p>ğŸ¥‰ 3Âº: R$ ${data.terceiro}</p>
<p>ğŸ‘¥ Vagas: ${vagas} / ${data.limite}</p>

<input id="telefone-${docSnap.id}" placeholder="Seu telefone">

<button onclick="inscrever('${docSnap.id}','pix')">Pagar via Pix</button>
<button onclick="inscrever('${docSnap.id}','pessoal')">Pago pessoalmente</button>

<div class="pix-box" id="pix-${docSnap.id}">
<p>FaÃ§a o Pix para:</p>
<p><b>bernardemachado14@gmail.com</b></p>
<img src="https://i.postimg.cc/qMX1XykM/Screenshot-20260221-125915-Inter.jpg" width="200">
<p>ApÃ³s o pagamento, aguarde aprovaÃ§Ã£o.</p>
</div>
</div>
`;
});
}

window.inscrever = async function(id,metodo){
const user = auth.currentUser;
const telefone = document.getElementById("telefone-"+id).value;

const inscritosRef = collection(db,"torneios",id,"inscritos");
const inscritosSnap = await getDocs(inscritosRef);
const torneioDoc = await getDoc(doc(db,"torneios",id));
const limite = torneioDoc.data().limite;

if(inscritosSnap.size >= limite){
alert("InscriÃ§Ãµes encerradas!");
return;
}

await addDoc(inscritosRef,{
nome:user.email,
email:user.email,
telefone:telefone,
pagamento:metodo,
status:"pendente",
data:new Date()
});

if(metodo==="pix"){
document.getElementById("pix-"+id).style.display="block";
}else{
alert("Aguarde aprovaÃ§Ã£o manual.");
}

alert("InscriÃ§Ã£o enviada!");
carregarTorneios();
}

</script>
</body>
</html>
