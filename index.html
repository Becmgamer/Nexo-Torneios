<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NEXO Studio - Torneios</title>

<style>
body{
    background:#0f0f0f;
    color:white;
    font-family:Arial;
    text-align:center;
}
.card{
    background:#1c1c1c;
    margin:20px;
    padding:20px;
    border-radius:15px;
    box-shadow:0 0 20px #00ffff55;
}
button{
    background:linear-gradient(45deg,#00ffff,#00ff88);
    border:none;
    padding:10px 20px;
    border-radius:10px;
    cursor:pointer;
    margin:10px;
    font-weight:bold;
}
input{
    padding:8px;
    margin:5px;
    border-radius:8px;
    border:none;
}
.hidden{
    display:none;
}
img{
    width:200px;
    border-radius:15px;
}
</style>
</head>

<body>

<h1>ğŸ® NEXO Studio - Torneios</h1>

<!-- LOGIN -->
<div id="loginDiv">
    <h2>Login</h2>
    <input type="email" id="email" placeholder="Digite seu e-mail"><br>
    <input type="password" id="senha" placeholder="Digite sua senha"><br>
    <button onclick="login()">Entrar</button>
</div>

<!-- TORNEIOS -->
<div id="torneiosDiv" class="hidden">
    <h2>Torneios DisponÃ­veis</h2>
    <div id="listaTorneios"></div>
</div>

<!-- PAGAMENTO -->
<div id="pagamentoDiv" class="hidden">
    <h2>Escolha a forma de pagamento</h2>
    
    <p id="torneioEscolhido"></p>

    <input type="text" id="telefone" placeholder="Seu nÃºmero (WhatsApp)" required><br>

    <button onclick="pagarPix()">ğŸ’³ Pagar via Pix</button>
    <button onclick="pagarPessoal()">ğŸ’µ Pago pessoalmente</button>

    <div id="pixArea" class="hidden">
        <h3>Pix:</h3>
        <p>bernardemachado14@gmail.com</p>
        <img src="COLE_AQUI_LINK_QR_CODE">
        <p>ApÃ³s pagar, aguarde aprovaÃ§Ã£o.</p>
    </div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, getDocs, addDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_AUTH_DOMAIN",
  projectId: "SEU_PROJECT_ID",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let usuarioAtual = null;
let torneioSelecionado = null;

window.login = async function(){
    const email = document.getElementById("email").value;
    const senha = document.getElementById("senha").value;

    await signInWithEmailAndPassword(auth,email,senha);
}

onAuthStateChanged(auth,(user)=>{
    if(user){
        usuarioAtual = user;
        document.getElementById("loginDiv").classList.add("hidden");
        document.getElementById("torneiosDiv").classList.remove("hidden");
        carregarTorneios();
    }
});

async function carregarTorneios(){
    const querySnapshot = await getDocs(collection(db,"tournaments"));
    const lista = document.getElementById("listaTorneios");
    lista.innerHTML="";

    querySnapshot.forEach((docu)=>{
        const data = docu.data();
        if(data.ativo){
            lista.innerHTML += `
            <div class="card">
                <img src="${data.imagem}">
                <h3>${data.nome}</h3>
                <p>ğŸ“… Data: ${data.data}</p>
                <p>ğŸ’° Taxa: R$ ${data.taxa}</p>
                <p>ğŸ† 1Âº: R$ ${data.premio1}</p>
                <p>ğŸ¥ˆ 2Âº: R$ ${data.premio2}</p>
                <p>ğŸ¥‰ 3Âº: R$ ${data.premio3}</p>
                <button onclick="inscrever('${docu.id}','${data.nome}')">Inscrever-se</button>
            </div>
            `;
        }
    });
}

window.inscrever = function(id,nome){
    torneioSelecionado = id;
    document.getElementById("pagamentoDiv").classList.remove("hidden");
    document.getElementById("torneioEscolhido").innerText = "Torneio: "+nome;
}

window.pagarPix = async function(){
    document.getElementById("pixArea").classList.remove("hidden");
    await salvarInscricao("pix");
}

window.pagarPessoal = async function(){
    await salvarInscricao("pessoal");
    alert("InscriÃ§Ã£o enviada. Aguarde confirmaÃ§Ã£o.");
}

async function salvarInscricao(tipo){
    const telefone = document.getElementById("telefone").value;

    await addDoc(collection(db,"tournaments",torneioSelecionado,"inscritos"),{
        uid: usuarioAtual.uid,
        email: usuarioAtual.email,
        telefone: telefone,
        pagamento: tipo,
        aprovado: false,
        data: new Date()
    });
}

</script>
</body>
</html>
