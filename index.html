<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Torneio Brawl Stars - Nexo Studios</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:white;
  text-align:center;
}

.container{
  padding:20px;
}

input, button{
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:none;
  font-size:16px;
  width:90%;
  max-width:300px;
}

button{
  background:#00c6ff;
  color:white;
  cursor:pointer;
}

button:hover{
  opacity:0.9;
}

.card{
  background:rgba(255,255,255,0.1);
  padding:15px;
  border-radius:12px;
  margin:15px auto;
  max-width:400px;
}

img{
  width:100%;
  border-radius:10px;
}

#telaParabens{
  display:none;
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:black;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  z-index:9999;
}

canvas{
  position:absolute;
  top:0;
  left:0;
}
</style>
</head>
<body>

<div class="container">

<h2>üèÜ Torneio de Brawl Stars</h2>

<!-- LOGIN -->
<div id="login">
<input type="text" id="telefone" placeholder="Digite seu n√∫mero com DDD">
<br>
<button onclick="fazerLogin()">Entrar</button>
</div>

<!-- TORNEIO -->
<div id="torneio" style="display:none;">
<div class="card">

<img src="https://i.postimg.cc/vBDwTGw1/cropped.webp">

<h3>Torneio Oficial</h3>
<p><b>Data:</b> 1¬∫ de Mar√ßo √†s 16:00</p>
<p><b>Taxa:</b> R$ 5,00</p>
<p><b>Vagas:</b> <span id="vagas">Carregando...</span></p>

<button onclick="pagarPix()">Pagar via Pix</button>
<button onclick="pagarPessoal()">Pago pessoalmente</button>

</div>
</div>

</div>

<!-- TELA PARAB√âNS -->
<div id="telaParabens">
<h1>üéâ PARAB√âNS! üéâ</h1>
<p>Voc√™ foi aprovado no torneio!</p>
<button onclick="voltarInicio()">Voltar ao in√≠cio</button>
<canvas id="confete"></canvas>
</div>

<!-- FIREBASE -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

// üî• COLE SUA CONFIG AQUI
const firebaseConfig = {
  apiKey: "AIzaSyDj5-aBr2n_wg80HswcaIOjetm7DtxILSI",
  authDomain: "nexostudios-site-e9458.firebaseapp.com",
  databaseURL: "https://nexostudios-site-e9458-default-rtdb.firebaseio.com",
  projectId: "nexostudios-site-e9458",
  storageBucket: "nexostudios-site-e9458.firebasestorage.app",
  messagingSenderId: "247851109985",
  appId: "1:247851109985:web:1b8903891240c55a376420"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let telefoneAtual = "";
let vagasRestantes = 20;

// LOGIN
window.fazerLogin = async function(){
  telefoneAtual = document.getElementById("telefone").value;

  if(telefoneAtual.length < 10){
    alert("Digite n√∫mero v√°lido");
    return;
  }

  document.getElementById("login").style.display="none";
  document.getElementById("torneio").style.display="block";

  document.getElementById("vagas").innerText = vagasRestantes;
}

// PIX
window.pagarPix = async function(){
  await salvarInscricao("Pix");
}

// PESSOAL
window.pagarPessoal = async function(){
  await salvarInscricao("Pessoalmente");
}

async function salvarInscricao(tipo){
  if(vagasRestantes <= 0){
    alert("Sem vagas!");
    return;
  }

  await setDoc(doc(db,"inscricoes",telefoneAtual),{
    telefone: telefoneAtual,
    pagamento: tipo,
    aprovado: true,
    data: new Date()
  });

  vagasRestantes--;
  document.getElementById("vagas").innerText = vagasRestantes;

  mostrarParabens();
}

// PARAB√âNS
window.mostrarParabens = function(){
  document.getElementById("telaParabens").style.display="flex";
  iniciarConfete();
}

window.voltarInicio = function(){
  window.location.href="https://sites.google.com/view/nexostudios/in%C3%ADcio";
}

// CONFETE
function iniciarConfete(){
  const canvas = document.getElementById("confete");
  const ctx = canvas.getContext("2d");

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  let confetes=[];

  for(let i=0;i<100;i++){
    confetes.push({
      x:Math.random()*canvas.width,
      y:Math.random()*canvas.height,
      r:Math.random()*6+4
    });
  }

  function desenhar(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="white";
    for(let c of confetes){
      ctx.beginPath();
      ctx.arc(c.x,c.y,c.r,0,Math.PI*2);
      ctx.fill();
      c.y+=3;
      if(c.y>canvas.height) c.y=0;
    }
  }

  setInterval(desenhar,20);
}

</script>

</body>
</html>
